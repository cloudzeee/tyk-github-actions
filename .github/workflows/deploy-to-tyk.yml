- name: Deploy simple-api to Tyk
  run: |
    echo "Sending POST request to Tyk..."
    RESPONSE=$(curl -s -o response.json -w "%{http_code}" \
      -H "Authorization: ${{ secrets.TYK_LOCAL_API_KEY }}" \
      -H "Content-Type: application/json" \
      -X POST ${{ secrets.TYK_LOCAL_DASHBOARD_URL }}/api/apis \
      -d @api-definitions/simple-api.json)

    echo "Response Code: $RESPONSE"
    cat response.json

    if [ "$RESPONSE" -ne 200 ]; then
      echo "‚ùå Failed to deploy simple-api"
      exit 1
    fi
